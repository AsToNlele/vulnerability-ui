import React from 'react';
import { Title, Card, CardHeader, CardBody, Split, SplitItem } from '@patternfly/react-core';
import propTypes from 'prop-types';
import TrendBox from './TrendBox';
import { connect } from 'react-redux';
import { withRouter } from 'react-router-dom';
import { fetchDummyData } from '../../../Store/Actions/DummyActions';

class ChangesSinceLastLoginCard extends React.Component {
    constructor(props) {
        super(props);
    }

    componentDidMount() {
        this.props.fetchData();
    }
    render() {
        return (
            <Card id="current-vulnerabilities">
                <CardHeader>
                    <Title size="lg">Changes since last login</Title>
                </CardHeader>
                <CardBody>
                    <Split gutter="lg">
                        <SplitItem variant="primary">
                            <TrendBox
                                number={this.props.newVulnerabilities.number}
                                percentage={this.props.newVulnerabilities.percentage}
                                direction={this.props.newVulnerabilities.direction}
                                label={'New Vulnerabilities'}
                            />
                        </SplitItem>
                        <SplitItem variant="primary">
                            <TrendBox number={0} percentage={0} label={'Newly affected Systems/Groups'} />
                        </SplitItem>
                        <SplitItem variant="primary">
                            <TrendBox number={23} percentage={50} direction={'down'} label={'Remediated CVEs'} />
                        </SplitItem>
                        <SplitItem variant="primary">
                            <TrendBox number={120} percentage={75} direction={'down'} label={'Newly secured Systems/Groups'} />
                        </SplitItem>
                    </Split>
                </CardBody>
            </Card>
        );
    }
}

ChangesSinceLastLoginCard.propTypes = {
    vulnerabilitiesNumber: propTypes.number,
    systemsAndGroups: propTypes.number
};

function mapStateToProps(state) {
    return {
        newVulnerabilities: state.DummyStore.newVulnerabilities
    };
}

const mapDispatchToProps = dispatch => {
    return {
        fetchData: () => dispatch(fetchDummyData())
    };
};

export default withRouter(
    connect(
        mapStateToProps,
        mapDispatchToProps
    )(ChangesSinceLastLoginCard)
);
