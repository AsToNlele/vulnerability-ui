import { withRouter } from 'react-router-dom';
import React from 'react';
import propTypes from 'prop-types';

/**
 * This is a dumb component that only recieves properties from a smart component.
 * Dumb components are usually functions and not classes.
 *
 * @param props the props given by the smart component.
 */

/*eslint camelcase: ["error", {properties: "never"}]*/

export const CVEProperties = {
    synopsis: 'Synopsis',
    impact: 'Impact',
    public_date: 'Public date',
    modified_date: 'Modified date',
    cwe_list: 'CWE',
    secondary_url: 'URL',
    cvss3_score: 'Cvss3 Score'
};

function processRows(props) {
    let arr = [];

    for (let column in CVEProperties) {
        arr.push(createColumn(column, props[column]));
    }

    return arr;
}

function createColumn(key, value) {
    let size = 'auto';
    switch (key) {
        case 'synopsis':
            size = '20%';
            break;
        case 'impact':
            size = '10%';
            break;
        case 'secondary_url':
            size = '10%';
            break;
        case 'cwe_list':
            size = '20%';
            break;
        case 'cvss_score':
            size = '5%';
    }

    return (
        <td key={key} style={{ width: size }}>
            {value}
        </td>
    );
}

const CVERow = props => {
    let arr = processRows(props);
    return (
        <React.Fragment>
            <tr
                onClick={() => {
                    props.history.push('/vulnerabilities/'.concat(props.synopsis.props.children));
                }}
            >
                {arr}
            </tr>
        </React.Fragment>
    );
};

CVERow.propTypes = {
    history: propTypes.object,
    synopsis: propTypes.object
};

export default withRouter(CVERow);
