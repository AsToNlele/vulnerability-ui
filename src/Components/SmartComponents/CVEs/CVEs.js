import { InfoCircleIcon } from '@patternfly/react-icons';
import { routerParams, Vulnerabilities, VulnerabilitiesCves } from '@red-hat-insights/insights-frontend-components';
import propTypes from 'prop-types';
import React from 'react';
import { createCveListByAccount } from '../../../Helpers/VulnerabilitiesHelper';
import { fetchCveListByAccount } from '../../../Store/Actions/Actions';

class CVEs extends React.Component {
    constructor(props) {
        super(props);
    }

    render() {
        const { entity } = this.props;
        const Component = (entity && Vulnerabilities) || VulnerabilitiesCves;
        const params = (entity && { entity }) || this.props;
        return <Component {...params} />;
    }
}

CVEs.defaultProps = {
    header: [
        { title: ' ', key: 'impact', width: 3 },
        { title: 'Name', key: 'synopsis', width: 10 },
        { title: 'Description', key: 'description', hasSort: false },
        {
            title: (
                <React.Fragment>
                    {'CVSS Base Score'} <InfoCircleIcon />
                </React.Fragment>
            ),
            key: 'cvss_score',
            width: 10
        },
        { title: 'Systems Exposed', key: 'systems_affected', width: 3 },
        { title: 'Publish date', key: 'public_date', width: 10 }
    ],
    fetchResource: fetchCveListByAccount,
    dataMapper: createCveListByAccount,
    showAllCheckbox: true
};

CVEs.propTypes = {
    dataMapper: propTypes.func,
    fetchResource: propTypes.func,
    header: propTypes.array,
    showAllCheckbox: propTypes.bool,
    entity: propTypes.shape({})
};

export default routerParams(CVEs);
