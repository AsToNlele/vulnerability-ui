import * as ActionTypes from '../../Store/ActionTypes';
import * as CVEHelper from '../../Helpers/CVE/CVEHelper';
import ReducerRegistry from '../../Utilities/ReducerRegistry';
import { CVEReducer } from '../../Store/Reducers/CVEStore';

ReducerRegistry.register({ CVEStore: CVEReducer });

export const fetchCVEListFromVMaaS = apiProps => ({
    type: ActionTypes.FETCH_CVES,
    payload: new Promise(resolve => {
        resolve(CVEHelper.getVMaaSCVEs(apiProps));
    })
});

export const fetchCVEsWithSystems = apiProps => ({
    type: ActionTypes.FETCH_CVES_WITH_SYSTEMS,
    payload: new Promise(resolve => {
        resolve(CVEHelper.getCVEsWithSystems(apiProps));
    })
});

export const searchCVEs = value => ({
    type: ActionTypes.FILTER_CVES,
    payload: new Promise(resolve => {
        resolve(value);
    })
});

export const fetchCveDetails = synopsis => ({
    type: ActionTypes.FETCH_CVE_DETAILS,
    payload: new Promise(resolve => {
        resolve(CVEHelper.getCveDetails(synopsis));
    }).then(result => result)
});
