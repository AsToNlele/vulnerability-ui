import * as APIHelper from '../../Helpers/APIHelper';
import ReducerRegistry from '../../Utilities/ReducerRegistry';
import * as ActionTypes from '../ActionTypes';
import { CVEReducer } from '../Reducers/CVEStore';

ReducerRegistry.register({ CVEStore: CVEReducer });

export const fetchAffectedSystemsByCVE = apiProps => ({
    type: ActionTypes.FETCH_AFFECTED_SYSTEMS_BY_CVE,
    payload: new Promise(resolve => {
        resolve(APIHelper.getAffectedSystemsByCVE(apiProps));
    }).then(result => result)
});

export const fetchCveDetails = synopsis => ({
    type: ActionTypes.FETCH_CVE_DETAILS,
    payload: new Promise(resolve => {
        resolve(APIHelper.getCveDetails(synopsis));
    }).then(result => result)
});
