import * as ActionTypes from '../../Store/ActionTypes';

// Initial State
const initialState = {
    cveList: {
        isLoading: true,
        items: {}
    },
    cveListWithSystems: {
        isLoading: true,
        items: []
    }
};

// Reducer
export const CVEReducer = (state = initialState, action) => {
    switch (action.type) {
        case ActionTypes.FETCH_CVES + '_PENDING':
            return {
                ...state,
                cveList: {
                    items: state.cveList.items,
                    isLoading: true
                }
            };
        case ActionTypes.FETCH_CVES + '_FULFILLED':
            return {
                ...state,
                cveList: {
                    items: action.payload,
                    isLoading: false
                }
            };
        case ActionTypes.FETCH_CVES_WITH_SYSTEMS + '_PENDING':
            return {
                ...state,
                cveListWithSystems: {
                    items: state.cveListWithSystems.items,
                    isLoading: true
                }
            };
        case ActionTypes.FETCH_CVES_WITH_SYSTEMS + '_FULFILLED':
            return {
                ...state,
                cveListWithSystems: {
                    items: action.payload,
                    isLoading: false
                }
            };
        case ActionTypes.FILTER_CVES + '_FULFILLED':
            return {
                ...state,
                filterValue: action.payload
            };
        default:
            return state;
    }
};
