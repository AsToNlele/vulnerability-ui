import { createApiCall } from './APIHelper';

export function getChanges() {
    let endpoint = '/vulnerabilities/changes/';
    let result = createApiCall(endpoint, 'get');
    return result;
}

export function getCurrentImpacts() {
    let endpoint = '/vulnerabilities/impacts/';
    let result = createApiCall(endpoint, 'get');
    return result;
}

export function createChangesSinceCard(changes) {
    let dataSet = changes.payload;
    let isLoading = changes.isLoading;
    if (!isLoading) {
        let payload = changes.payload;
        dataSet = {
            newVulnerabilities: payload.new_vulnerabilities,
            newlyAffectedSystems: payload.newly_affected,
            remediatedCVEs: payload.remediated
        };
    }

    dataSet = { content: dataSet, isLoading };
    return dataSet;
}

export function createCurrentVulnerabilitiesCard(impacts) {
    let dataSet = impacts.payload;
    let isLoading = impacts.isLoading;
    if (!isLoading) {
        dataSet = impacts.payload;
    }

    dataSet = { content: dataSet, isLoading };
    return dataSet;
}
