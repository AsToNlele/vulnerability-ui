import React from 'react';
import {loadDemoCVEs} from "demoData/cves";
import CVERow from "Components/PresentationalComponents/Vulnerability/CVERow";

export function getCVEs() {
    return loadDemoCVEs.cve_list;
}

export function fetchDataAsync() {
    var rawcves = getCVEs();
    var rows = [];
    for (var row in rawcves) {
        var row = processCVErow(row, rawcves[row]);
        rows.push(row);
    }
    return rows;
}

function processCVErow(key, data) {
    var modifiedData = {
        ...data,
        synopsis: <b>{data["synopsis"]}</b>,
        cwe_list: processCWElist(data["cwe_list"]),
        public_date: processDate(data["public_date"]),
        modified_date: processDate(data["modified_date"]),
        impact: processImpact(data["impact"])
    };
    return <CVERow key={key}{...modifiedData}/>
}

function processCWElist(cwes) {
    let new_list = cwes.map((item) =>
        <span className="pf-c-badge pf-m-read" key={item}>{item}</span>
    );
    return new_list;
}

function processDate(date_string) {
    let date = new Date(date_string);
    return date.toLocaleDateString();
}

function processImpact(impact) {
    switch (impact) {
        case "Important":
            return <span><i className="fas fa-exclamation-circle" style={{color: "#f0ab00"}}></i> {impact}</span>;
        case "Moderate":
            return <span><i className="fas fa-exclamation-circle"></i> {impact}</span>;
        case "Critical":
            return <span><i className="fas fa-exclamation-circle" style={{color: "#c00"}}></i> {impact}</span>;
            case "Low":
            return <span><i className="fas fa-exclamation-circle" style={{color: "#72767b"}}></i> {impact}</span>;
    }
}