import { getRegistry } from '@red-hat-insights/insights-frontend-components';
import { notificationsMiddleware } from '@red-hat-insights/insights-frontend-components/components/Notifications/';
import MiddlewareListener from '@red-hat-insights/insights-frontend-components/Utilities/MiddlewareListener';
import logger from 'redux-logger';
import promiseMiddleware from 'redux-promise-middleware';

export const middlewareListener = new MiddlewareListener();

const registry = getRegistry({}, [
    promiseMiddleware(),
    notificationsMiddleware({ dispatchDefaultFailure: false }),
    middlewareListener.getMiddleware(),
    logger
]);

export default {
    getStore: () => registry.getStore(),
    register: newReducers => {
        registry.register(newReducers);
    }
};
